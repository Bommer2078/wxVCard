{"version":3,"sources":["uni-app:///main.js",null,"webpack:///K:/project/vcard/quanyika/pages/confirmPage/confirmPage.vue?0cb5","webpack:///K:/project/vcard/quanyika/pages/confirmPage/confirmPage.vue?1d57","webpack:///K:/project/vcard/quanyika/pages/confirmPage/confirmPage.vue?ad94","uni-app:///pages/confirmPage/confirmPage.vue","webpack:///K:/project/vcard/quanyika/pages/confirmPage/confirmPage.vue?3b13","webpack:///K:/project/vcard/quanyika/pages/confirmPage/confirmPage.vue?fcd1"],"names":["createPage","Page"],"mappings":"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","file":"pages/confirmPage/confirmPage.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/confirmPage/confirmPage.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./confirmPage.vue?vue&type=template&id=aed32ece&\"\nvar renderjs\nimport script from \"./confirmPage.vue?vue&type=script&lang=js&\"\nexport * from \"./confirmPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./confirmPage.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"project/vcard/quanyika/pages/confirmPage/confirmPage.vue\"\nexport default component.exports","export * from \"-!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirmPage.vue?vue&type=template&id=aed32ece&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.specsArr, function(item, index) {\n    var f0 = _vm._f(\"priceText\")(item.price)\n\n    return {\n      $orig: _vm.__get_orig(item),\n      f0: f0\n    }\n  })\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirmPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirmPage.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"buy-page\">\r\n        <view class=\"container-cover\">\r\n            <view class=\"vcard-name\">{{vCardBaseInfo.name}}</view>\r\n            <view style=\"margin-bottom: 180rpx;\">                \r\n                <view \r\n                    class=\"specs\" \r\n                    v-for=\"(item,index) in specsArr\" \r\n                    :key=\"index\" \r\n                    :class=\"{'active-item':skuId === item.id}\"\r\n                    @click=\"choseItem(item)\">\r\n                    <view class=\"specs-title\">\r\n                        {{item.name}}\r\n                        <view class=\"specs-tip\">\r\n                            场馆特惠\r\n                        </view>\r\n                    </view>\r\n                    <view class=\"price\">\r\n                        ￥{{item.price | priceText}}\r\n                    </view>\r\n                    <image class=\"confirm-img\" src=\"../../static/confirm.png\" v-if=\"skuId === item.id\"/>\r\n                </view>\r\n            </view>\r\n            <view class=\"open-btn\" @click=\"handlePay\" v-if=\"showPayBtn\">立即开通</view>\r\n        \t<login-btn btn-txt=\"快速登录\" v-else></login-btn>\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex' \r\nimport md5 from '../../libs/md5.min.js'\r\nimport loginBtn from '../../components/loginBtn'\r\nexport default {\r\n    data() {\r\n        return {\r\n            skuId: '',\r\n            vCardId: '',\r\n            forbidClick: false,\r\n            venueId: '',\r\n            expandValue: ''\r\n        }\r\n    },    \r\n    onLoad (option) {\r\n        this.vCardId = option.vCardId\r\n        this.venueId = option.venueId\r\n        this.expandValue = option.expandValue\r\n        this.getVCardObj()\r\n    },  \r\n\tonShow() {\t\t\r\n\t\tif (wx.canIUse('hideHomeButton')) {\r\n\t\t\twx.hideHomeButton()\r\n\t\t}\r\n\t},  \r\n    computed: {\r\n        ...mapState(['vCardBaseInfo','userInfo']),\r\n        specsArr() {\r\n            let obj =  JSON.parse(JSON.stringify(this.vCardBaseInfo))\r\n            if (obj) {\r\n                return obj.sku_arr\r\n            }\r\n            return []\r\n        },\r\n        showPayBtn () {\r\n            return this.userInfo && this.userInfo.openid\r\n        }\r\n    },\r\n\tcomponents: {\r\n\t\tloginBtn\r\n\t},\r\n    watch: {\r\n        specsArr(newVal) {\r\n            if (newVal && newVal.length === 1) {\r\n                this.skuId = newVal[0].id\r\n            }\r\n        }\r\n    },\r\n    filters: {\r\n        priceText(price) {\r\n            return (price/100).toFixed(2)\r\n        }\r\n    },\r\n    methods: {\r\n        async getVCardObj () {                                \r\n            let params = {\r\n                id: this.vCardId\r\n            }               \r\n            const res = await this.$api.getCardDetail(params)\r\n            if (res.code === 0) {\r\n                this.$store.commit('SET_TICKET_OBJ',res.data)\r\n            }       \r\n        },\r\n        choseItem (item) {\r\n            this.skuId = item.id\r\n        },\r\n        async handlePay () {\r\n            if (this.forbidClick) return\r\n            if (!this.skuId) {\r\n                this.$tip.toast('请选择规格','none')\r\n                return\r\n            }\r\n            this.forbidClick = true\r\n            let pramas = {\r\n                card_id: this.vCardId,\r\n                card_sku_id: this.skuId,\r\n                venue_id: this.venueId,\r\n                expand_value: this.expandValue,\r\n            }\r\n            const res = await this.$api.purchase(pramas)\r\n            if (res.code === 0) {\r\n                this.handleWxPay(res.data.id)\r\n                this.$tip.toast('下单成功','none')\r\n            } else {  \r\n                this.$tip.alertDialog(res.msg) \r\n                setTimeout(() => {                    \r\n                    this.forbidClick = false\r\n                },3000)             \r\n            }\r\n        },\r\n        async handleWxPay (id) {\r\n            let pramas = {\r\n                order_id: id\r\n            }\r\n            const res = await this.$api.wxPay(pramas)\r\n            if (res.code === 0) {\r\n                this.payConfirm(res.data)\r\n            } else {  \r\n                this.$tip.alertDialog(res.msg) \r\n                setTimeout(() => {                    \r\n                    this.forbidClick = false\r\n                },3000)             \r\n            }\r\n        },\r\n        payConfirm (obj) {\r\n            let timeStamp = new Date().getTime()\r\n            let paySign = `appId=wx1e383d6c91e8432f&nonceStr=${obj.nonce_str}&package=prepay_id=${obj.prepay_id}&signType=MD5&timeStamp=${timeStamp}&key=0cd82b0fa72de1948bfee7d277c42053`\r\n            paySign = md5(paySign)\r\n            let that = this\r\n            uni.requestPayment({\r\n                timeStamp: String(timeStamp),\r\n                nonceStr: obj.nonce_str,\r\n                package: `prepay_id=${obj.prepay_id}`,\r\n                signType: 'MD5',\r\n                paySign: paySign,\r\n                success: function() {                    \r\n                    that.$tip.alertDialog(\r\n                        '支付成功，请跳转订单查看',\r\n                        '好的','不用了').then(() => {\r\n                            uni.redirectTo({\r\n                                url: '/pages/orderList/orderList',\r\n                            });\r\n                        }).catch(() => {                            \r\n                            uni.switchTab({\r\n                                 url: '/pages/main/main'\r\n                            });\r\n                        }) \r\n                },\r\n                fail: function(err) {                       \r\n                    that.$tip.toast(`支付失败，请查看订单`,'none')\r\n                }\r\n            })\r\n        }, \r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n    .buy-page {\r\n        display: flex;\r\n        width: 100%;\r\n        height: 100vh;\r\n        padding: 15rpx 15rpx 0;\r\n        background: #F3F3F3;\r\n        .container-cover {\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            width: 100%;\r\n            height: 1075rpx;\r\n            padding-top: 25rpx;\r\n            background: #fff;\r\n            .vcard-name {\r\n                width: 100%;\r\n                padding-left: 20upx;\r\n                margin-bottom: 30upx;\r\n            }\r\n            .specs {\r\n                position: relative;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: space-between;\r\n                width: 696rpx;\r\n                height: 105rpx;\r\n                color: #727272;\r\n                border-radius: 10rpx;\r\n                margin-bottom: 40rpx;\r\n                border:1px solid rgba(193,193,193,1);\r\n                .specs-title {\r\n                    display: flex;\r\n                    font-weight: 700;\r\n                    align-items: center;\r\n                    justify-content: space-between;\r\n                    font-size: 32rpx;\r\n                    margin-left: 30rpx;\r\n                    .specs-tip {\r\n                        width: 80rpx;\r\n                        height: 24rpx;\r\n                        color: #666;\r\n                        font-size: 18rpx;\r\n                        font-weight: 400;\r\n                        line-height: 24rpx;\r\n                        text-align: center;\r\n                        border-radius: 12rpx;\r\n                        margin-left: 16rpx;\r\n                        border: 1px solid #D4D4D4;\r\n                    }\r\n                }\r\n                .price {\r\n                    font-size: 30rpx;\r\n                    margin-right: 18rpx;\r\n                }\r\n            }\r\n            .active-item {\r\n                border: 2px solid #FF3276;\r\n                .specs-title {\r\n                    color: #FF3276;\r\n                }\r\n                .price {\r\n                    color: #FF3276;\r\n                }\r\n            }\r\n            .exchange-btn {                \r\n                width: 696rpx;\r\n                height: 105rpx;\r\n                position: relative;\r\n                font-weight: 700;\r\n                color: #727272;\r\n                line-height: 105rpx;\r\n                background: #F1F1F1;\r\n                border-radius: 10rpx;\r\n                font-size: 32rpx;\r\n                padding-left: 30rpx;\r\n                margin-bottom: 160rpx;\r\n                &::after {\r\n                    content: '';\r\n                    position: absolute;\r\n                    top: 40rpx;\r\n                    right: 20rpx;\r\n                    width: 20rpx;\r\n                    height: 20rpx;\r\n                    border: 1px solid;\r\n                    transform: rotate(45deg);\r\n                    border-color: #727272 #727272 transparent transparent;\r\n                }\r\n            }\r\n            .open-btn {\r\n                width: 563rpx;\r\n                height: 80rpx;\r\n                color: #fff;\r\n                font-size: 34rpx;\r\n                line-height: 80rpx;\r\n                text-align: center;\r\n                border-radius:20px;\r\n                background: #FF3276;\r\n            }\r\n        }\r\n        .confirm-img {\r\n            width: 45rpx;\r\n            height: 37rpx;\r\n            position: absolute;\r\n            bottom:0;\r\n            right:0;\r\n        }\r\n    }\r\n</style>","import mod from \"-!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirmPage.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../app/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirmPage.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1603039447895\n      var cssReload = require(\"K:/app/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}